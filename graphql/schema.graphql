scalar Time

enum LLMProvider {
  OPENAI
  CLAUDE
  GEMINI
}

enum AgentStatus {
  ACTIVE
  ARCHIVED
}

type Thread {
  id: ID!
  teamId: String!
  channelId: String!
  threadTs: String!
  createdAt: Time!
  updatedAt: Time!
}

type ThreadsResponse {
  threads: [Thread!]!
  totalCount: Int!
}

type User {
  id: ID!
  slackName: String!
  displayName: String!
  email: String
  createdAt: Time!
  updatedAt: Time!
}

type Agent {
  id: ID!
  agentId: String!
  name: String!
  description: String!
  author: User!
  status: AgentStatus!
  latest: String
  createdAt: Time!
  updatedAt: Time!
  latestVersion: AgentVersion
}

type AgentVersion {
  agentUuid: ID!
  version: String!
  systemPrompt: String!
  llmProvider: LLMProvider
  llmModel: String
  createdAt: Time!
  updatedAt: Time!
}

type AgentListResponse {
  agents: [Agent!]!
  totalCount: Int!
}

type AgentIdAvailability {
  available: Boolean!
  message: String!
}

type LLMModel {
  id: String!
  displayName: String!
  description: String!
}

type LLMProviderInfo {
  id: String!
  displayName: String!
  models: [LLMModel!]!
}

type LLMConfig {
  providers: [LLMProviderInfo!]!
  defaultProvider: String!
  defaultModel: String!
  fallbackEnabled: Boolean!
  fallbackProvider: String!
  fallbackModel: String!
}

input CreateAgentInput {
  agentId: String!
  name: String!
  description: String
  systemPrompt: String
  llmProvider: LLMProvider!
  llmModel: String!
  version: String
}

input UpdateAgentInput {
  agentId: String
  name: String
  description: String
  systemPrompt: String
  llmProvider: LLMProvider
  llmModel: String
}

input CreateAgentVersionInput {
  agentUuid: ID!
  version: String!
  systemPrompt: String
  llmProvider: LLMProvider!
  llmModel: String!
}

type Query {
  thread(id: ID!): Thread
  threads(offset: Int, limit: Int): ThreadsResponse!
  
  agent(id: ID!): Agent
  agentByAgentId(agentId: String!): Agent
  agents(offset: Int, limit: Int): AgentListResponse!
  allAgents(offset: Int, limit: Int): AgentListResponse!
  agentsByStatus(status: AgentStatus!, offset: Int, limit: Int): AgentListResponse!
  agentVersions(agentUuid: ID!): [AgentVersion!]!
  checkAgentIdAvailability(agentId: String!): AgentIdAvailability!
  
  user(id: ID!): User
  currentUser: User
  
  llmConfig: LLMConfig!
}

type Mutation {
  createAgent(input: CreateAgentInput!): Agent!
  updateAgent(id: ID!, input: UpdateAgentInput!): Agent!
  deleteAgent(id: ID!): Boolean!
  archiveAgent(id: ID!): Agent!
  unarchiveAgent(id: ID!): Agent!
  createAgentVersion(input: CreateAgentVersionInput!): AgentVersion!
  
  updateDefaultLLM(provider: String!, model: String!): LLMConfig!
  updateFallbackLLM(enabled: Boolean!, provider: String, model: String): LLMConfig!
}

schema {
  query: Query
  mutation: Mutation
}