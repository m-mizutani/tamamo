scalar Time
scalar Upload

enum LLMProvider {
  OPENAI
  CLAUDE
  GEMINI
}

enum AgentStatus {
  ACTIVE
  ARCHIVED
}

type Thread {
  id: ID!
  teamId: String!
  channelId: String!
  threadTs: String!
  createdAt: Time!
  updatedAt: Time!
}

type ThreadsResponse {
  threads: [Thread!]!
  totalCount: Int!
}

type User {
  id: ID!
  slackName: String!
  displayName: String!
  email: String
  createdAt: Time!
  updatedAt: Time!
}

type Agent {
  id: ID!
  agentId: String!
  name: String!
  description: String!
  author: User!
  status: AgentStatus!
  latest: String
  createdAt: Time!
  updatedAt: Time!
  latestVersion: AgentVersion
  image: AgentImage
  imageUrl: String
}

type AgentVersion {
  agentUuid: ID!
  version: String!
  systemPrompt: String!
  llmProvider: LLMProvider
  llmModel: String
  createdAt: Time!
  updatedAt: Time!
}

type AgentImage {
  id: ID!
  agentId: ID!
  storageKey: String!
  contentType: String!
  fileSize: Int!
  width: Int!
  height: Int!
  thumbnails: [ThumbnailInfo!]!
  createdAt: Time!
  updatedAt: Time!
}

type ThumbnailInfo {
  size: String!
  url: String!
}

type AgentListResponse {
  agents: [Agent!]!
  totalCount: Int!
}

type AgentIdAvailability {
  available: Boolean!
  message: String!
}

type LLMModel {
  id: String!
  displayName: String!
  description: String!
}

type LLMProviderInfo {
  id: String!
  displayName: String!
  models: [LLMModel!]!
}

type LLMConfig {
  providers: [LLMProviderInfo!]!
  defaultProvider: String!
  defaultModel: String!
  fallbackEnabled: Boolean!
  fallbackProvider: String!
  fallbackModel: String!
}

type JiraIntegration {
  id: ID!
  connected: Boolean!
  siteUrl: String
  connectedAt: Time
}

type JiraOAuthURL {
  url: String!
}

type NotionIntegration {
  id: ID!
  connected: Boolean!
  workspaceName: String
  workspaceIcon: String
  connectedAt: Time
}

type NotionOAuthURL {
  url: String!
}

# Agent search configuration types
type AgentSlackSearchConfig {
  id: ID!
  agentId: ID!
  channelId: String!
  channelName: String!
  description: String
  enabled: Boolean!
  createdAt: String!
  updatedAt: String!
}

type AgentJiraSearchConfig {
  id: ID!
  agentId: ID!
  projectKey: String!
  projectName: String!
  boardId: String
  boardName: String
  description: String
  enabled: Boolean!
  createdAt: String!
  updatedAt: String!
}

type AgentNotionSearchConfig {
  id: ID!
  agentId: ID!
  databaseId: String!
  databaseName: String!
  workspaceId: String!
  description: String
  enabled: Boolean!
  createdAt: String!
  updatedAt: String!
}

# Input types for search configurations
input CreateSlackSearchConfigInput {
  agentId: ID!
  channelId: String!
  channelName: String!
  description: String
  enabled: Boolean!
}

input UpdateSlackSearchConfigInput {
  channelName: String!
  description: String
  enabled: Boolean!
}

input CreateJiraSearchConfigInput {
  agentId: ID!
  projectKey: String!
  projectName: String!
  boardId: String
  boardName: String
  description: String
  enabled: Boolean!
}

input UpdateJiraSearchConfigInput {
  projectName: String!
  boardId: String
  boardName: String
  description: String
  enabled: Boolean!
}

input CreateNotionSearchConfigInput {
  agentId: ID!
  databaseId: String!
  databaseName: String!
  workspaceId: String!
  description: String
  enabled: Boolean!
}

input UpdateNotionSearchConfigInput {
  databaseName: String!
  workspaceId: String!
  description: String
  enabled: Boolean!
}

input CreateAgentInput {
  agentId: String!
  name: String!
  description: String
  systemPrompt: String
  llmProvider: LLMProvider!
  llmModel: String!
  version: String
}

input UpdateAgentInput {
  agentId: String
  name: String
  description: String
  systemPrompt: String
  llmProvider: LLMProvider
  llmModel: String
}

input CreateAgentVersionInput {
  agentUuid: ID!
  version: String!
  systemPrompt: String
  llmProvider: LLMProvider!
  llmModel: String!
}

type Query {
  thread(id: ID!): Thread
  threads(offset: Int, limit: Int): ThreadsResponse!
  
  agent(id: ID!): Agent
  agentByAgentId(agentId: String!): Agent
  agents(offset: Int, limit: Int): AgentListResponse!
  allAgents(offset: Int, limit: Int): AgentListResponse!
  agentsByStatus(status: AgentStatus!, offset: Int, limit: Int): AgentListResponse!
  agentVersions(agentUuid: ID!): [AgentVersion!]!
  checkAgentIdAvailability(agentId: String!): AgentIdAvailability!
  
  agentImage(id: ID!): AgentImage
  agentImageByAgentId(agentId: ID!): AgentImage
  
  user(id: ID!): User
  currentUser: User
  
  llmConfig: LLMConfig!
  
  jiraIntegration: JiraIntegration
  notionIntegration: NotionIntegration
  
  # Search configuration queries
  agentSlackSearchConfigs(agentId: ID!): [AgentSlackSearchConfig!]!
  agentJiraSearchConfigs(agentId: ID!): [AgentJiraSearchConfig!]!
  agentNotionSearchConfigs(agentId: ID!): [AgentNotionSearchConfig!]!
}

type Mutation {
  createAgent(input: CreateAgentInput!): Agent!
  updateAgent(id: ID!, input: UpdateAgentInput!): Agent!
  deleteAgent(id: ID!): Boolean!
  archiveAgent(id: ID!): Agent!
  unarchiveAgent(id: ID!): Agent!
  createAgentVersion(input: CreateAgentVersionInput!): AgentVersion!
  
  uploadAgentImage(agentId: ID!, file: Upload!): Agent!
  
  updateDefaultLLM(provider: String!, model: String!): LLMConfig!
  updateFallbackLLM(enabled: Boolean!, provider: String, model: String): LLMConfig!
  
  initiateJiraOAuth: JiraOAuthURL!
  disconnectJira: Boolean!
  
  initiateNotionOAuth: NotionOAuthURL!
  disconnectNotion: Boolean!
  
  # Search configuration mutations
  createSlackSearchConfig(input: CreateSlackSearchConfigInput!): AgentSlackSearchConfig!
  updateSlackSearchConfig(id: ID!, input: UpdateSlackSearchConfigInput!): AgentSlackSearchConfig!
  deleteSlackSearchConfig(id: ID!): Boolean!
  
  createJiraSearchConfig(input: CreateJiraSearchConfigInput!): AgentJiraSearchConfig!
  updateJiraSearchConfig(id: ID!, input: UpdateJiraSearchConfigInput!): AgentJiraSearchConfig!
  deleteJiraSearchConfig(id: ID!): Boolean!
  
  createNotionSearchConfig(input: CreateNotionSearchConfigInput!): AgentNotionSearchConfig!
  updateNotionSearchConfig(id: ID!, input: UpdateNotionSearchConfigInput!): AgentNotionSearchConfig!
  deleteNotionSearchConfig(id: ID!): Boolean!
}

schema {
  query: Query
  mutation: Mutation
}